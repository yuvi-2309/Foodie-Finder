<div class="recommendations-container">
  <div class="hero-section">
    <div class="hero-content">
      <div class="hero-icon">
        <mat-icon>auto_awesome</mat-icon>
      </div>
      <h1>Recommended For You</h1>
      <p>Personalized restaurant suggestions based on your reviews and preferences</p>
    </div>
  </div>

  @if (isLoading()) {
    <div class="loading-container">
      <mat-spinner diameter="48"></mat-spinner>
      <p>Finding perfect restaurants for you...</p>
    </div>
  } @else if (error()) {
    <div class="error-state">
      <mat-icon>explore</mat-icon>
      <h2>{{ error() }}</h2>
      @if (!authService.isAuthenticated()) {
        <button mat-raised-button color="primary" (click)="goToLogin()">
          <mat-icon>login</mat-icon>
          Sign In
        </button>
      } @else {
        <button mat-raised-button color="primary" (click)="viewRestaurant('')">
          <mat-icon>explore</mat-icon>
          Browse Restaurants
        </button>
      }
    </div>
  } @else if (recommendations().length === 0) {
    <div class="empty-state">
      <mat-icon>rate_review</mat-icon>
      <h2>No recommendations yet</h2>
      <p>Start reviewing restaurants to get personalized suggestions!</p>
      <button mat-raised-button color="primary" (click)="viewRestaurant('')">
        <mat-icon>explore</mat-icon>
        Explore Restaurants
      </button>
    </div>
  } @else {
    <div class="recommendations-grid">
      @for (restaurant of recommendations(); track restaurant.id; let i = $index) {
        <mat-card class="recommendation-card" (click)="viewRestaurant(restaurant.id)">
          <div class="card-rank">#{{ i + 1 }}</div>
          <div class="card-image" [style.background-image]="'url(https://images.unsplash.com/photo-1517248135467-4c7edcad34c4?w=800)'">
            <div class="card-overlay">
              <mat-icon>restaurant</mat-icon>
            </div>
          </div>

          <mat-card-content>
            <h2>{{ restaurant.name }}</h2>

            <div class="rating-section">
              @if (restaurant.review_count > 0) {
                <div class="stars">
                  @for (star of getStarArray(restaurant.average_rating || 0); track $index) {
                    <mat-icon [class.filled]="star === 1">star</mat-icon>
                  }
                </div>
                <span class="rating-text">
                  {{ restaurant.average_rating || 0 | number: '1.1-1' }}
                  <span class="review-count">({{ restaurant.review_count }} reviews)</span>
                </span>
              } @else {
                <span class="no-reviews">Be the first to review!</span>
              }
            </div>

            <div class="location">
              <mat-icon>location_on</mat-icon>
              <span>{{ restaurant.address || restaurant.location }}</span>
            </div>
          </mat-card-content>

          <mat-card-actions>
            <button mat-button color="primary">
              View Restaurant
              <mat-icon>arrow_forward</mat-icon>
            </button>
          </mat-card-actions>
        </mat-card>
      }
    </div>
  }
</div>
