<mat-card class="review-form-card">
  <mat-card-header>
    <mat-card-title>Write a Review</mat-card-title>
    <mat-card-subtitle>Share your experience with the community</mat-card-subtitle>
  </mat-card-header>

  <mat-card-content>
    <form [formGroup]="reviewForm" (ngSubmit)="onSubmit()">
      <div class="rating-input">
        <label>Your Rating *</label>
        <div
          class="stars"
          (mouseleave)="clearHoverRating()"
        >
          @for (star of [1, 2, 3, 4, 5]; track star) {
            <mat-icon
              (click)="setRating(star)"
              (mouseenter)="setHoverRating(star)"
              [class.selected]="star <= selectedRating()"
            >
              {{ getStarIcon(star) }}
            </mat-icon>
          }
        </div>
        @if (selectedRating() === 0) {
          <span class="rating-hint">Click to rate</span>
        } @else {
          <span class="rating-selected">{{ selectedRating() }} out of 5 stars</span>
        }
      </div>

      <mat-form-field appearance="outline" class="full-width">
        <mat-label>Your Review</mat-label>
        <textarea
          matInput
          formControlName="content"
          rows="5"
          placeholder="What did you love? What could be better? Help others by sharing your experience..."
        ></textarea>
        @if (getErrorMessage('content')) {
          <mat-error>{{ getErrorMessage('content') }}</mat-error>
        }
      </mat-form-field>

      <!-- Photo Upload Section -->
      <div class="photo-section">
        <label class="photo-label">
          <mat-icon>add_a_photo</mat-icon>
          Add a Photo (optional)
        </label>
        <mat-form-field appearance="outline" class="full-width">
          <mat-label>Photo URL</mat-label>
          <input
            matInput
            formControlName="photo_url"
            placeholder="https://example.com/photo.jpg"
            (input)="onPhotoUrlChange()"
          />
          <mat-icon matSuffix>link</mat-icon>
        </mat-form-field>

        @if (photoPreview()) {
          <div class="photo-preview">
            <img [src]="photoPreview()" alt="Photo preview" />
            <button mat-icon-button class="remove-photo" (click)="clearPhoto()" type="button">
              <mat-icon>close</mat-icon>
            </button>
          </div>
        }
      </div>

      <div class="form-actions">
        @if (isSubmitting()) {
          <button mat-raised-button color="primary" type="submit" disabled>
            <mat-icon class="spin">sync</mat-icon>
            Submitting...
          </button>
        } @else {
          <button mat-raised-button color="primary" type="submit">
            <mat-icon>send</mat-icon>
            Submit Review
          </button>
        }
      </div>
    </form>
  </mat-card-content>
</mat-card>
